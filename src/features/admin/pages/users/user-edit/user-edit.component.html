<div class="page-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Editar Usuario</h1>
      <p class="page-description">Modifica la información del usuario seleccionado</p>
    </div>
    <div class="header-actions">
      <button 
        type="button" 
        class="btn btn-secondary" 
        (click)="onCancel()"
        [disabled]="loading">
        <i class="fas fa-arrow-left"></i>
        Volver
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loadingUser" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Cargando información del usuario...</p>
  </div>

  <!-- Form Container -->
  <div *ngIf="!loadingUser" class="form-container">
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
      
      <!-- Información Personal -->
      <div class="form-section">
        <h3 class="section-title">Información Personal</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="firstName">Nombre *</label>
            <input
              type="text"
              id="firstName"
              class="form-control"
              [class.error]="f['firstName'].invalid && f['firstName'].touched"
              formControlName="firstName"
              placeholder="Ingresa el nombre">
            <div class="error-message" *ngIf="getFieldError('firstName')">
              {{ getFieldError('firstName') }}
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="lastName">Apellido *</label>
            <input
              type="text"
              id="lastName"
              class="form-control"
              [class.error]="f['lastName'].invalid && f['lastName'].touched"
              formControlName="lastName"
              placeholder="Ingresa el apellido">
            <div class="error-message" *ngIf="getFieldError('lastName')">
              {{ getFieldError('lastName') }}
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="email">Email *</label>
            <input
              type="email"
              id="email"
              class="form-control"
              [class.error]="f['email'].invalid && f['email'].touched"
              formControlName="email"
              placeholder="ejemplo@correo.com">
            <div class="error-message" *ngIf="getFieldError('email')">
              {{ getFieldError('email') }}
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="phone">Teléfono *</label>
            <input
              type="tel"
              id="phone"
              class="form-control"
              [class.error]="f['phone'].invalid && f['phone'].touched"
              formControlName="phone"
              placeholder="+57 300 123 4567">
            <div class="error-message" *ngIf="getFieldError('phone')">
              {{ getFieldError('phone') }}
            </div>
          </div>
        </div>
      </div>

      <!-- Cambiar Contraseña (Opcional) -->
      <div class="form-section">
        <h3 class="section-title">Cambiar Contraseña (Opcional)</h3>
        <p class="section-description">Deja estos campos vacíos si no deseas cambiar la contraseña</p>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="password">Nueva Contraseña</label>
            <div class="password-input">
              <input
                [type]="showPassword ? 'text' : 'password'"
                id="password"
                class="form-control"
                [class.error]="f['password'].invalid && f['password'].touched"
                formControlName="password"
                placeholder="Ingresa la nueva contraseña">
              <button
                type="button"
                class="password-toggle"
                (click)="togglePasswordVisibility()">
                <i [class]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
              </button>
            </div>
            <div class="error-message" *ngIf="getFieldError('password')">
              {{ getFieldError('password') }}
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="confirmPassword">Confirmar Nueva Contraseña</label>
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="confirmPassword"
              class="form-control"
              [class.error]="f['confirmPassword'].invalid && f['confirmPassword'].touched"
              formControlName="confirmPassword"
              placeholder="Confirma la nueva contraseña">
            <div class="error-message" *ngIf="getFieldError('confirmPassword')">
              {{ getFieldError('confirmPassword') }}
            </div>
          </div>
        </div>
      </div>

      <!-- Configuración de Cuenta -->
      <div class="form-section">
        <h3 class="section-title">Configuración de Cuenta</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="role">Rol *</label>
            <select
              id="role"
              class="form-control"
              [class.error]="f['role'].invalid && f['role'].touched"
              formControlName="role">
              <option value="" disabled>Selecciona un rol</option>
              <option *ngFor="let role of roles" [value]="role.value">
                {{ role.label }}
              </option>
            </select>
            <div class="error-message" *ngIf="getFieldError('role')">
              {{ getFieldError('role') }}
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="status">Estado *</label>
            <select
              id="status"
              class="form-control"
              [class.error]="f['status'].invalid && f['status'].touched"
              formControlName="status">
              <option value="active">Activo</option>
              <option value="inactive">Inactivo</option>
              <option value="suspended">Suspendido</option>
            </select>
            <div class="error-message" *ngIf="getFieldError('status')">
              {{ getFieldError('status') }}
            </div>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button 
          type="button" 
          class="btn btn-secondary" 
          (click)="onCancel()"
          [disabled]="loading">
          Cancelar
        </button>
        
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="userForm.invalid || loading">
          <span *ngIf="loading" class="loading-spinner"></span>
          <span [class.loading-text]="loading">
            {{ loading ? 'Actualizando...' : 'Actualizar Usuario' }}
          </span>
        </button>
      </div>
      
    </form>
  </div>
</div>